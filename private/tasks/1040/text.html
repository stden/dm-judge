<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1251">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 10">
<meta name=Originator content="Microsoft Word 10">
<link rel=File-List href="text.files/filelist.xml">
<link rel=Edit-Time-Data href="text.files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>1040</title>
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:Zoom>BestFit</w:Zoom>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h2
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:14.0pt;
	font-family:Arial;
	font-style:italic;}
h3
	{mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	mso-outline-level:3;
	font-size:13.5pt;
	font-family:"Times New Roman";}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoBodyTextIndent, li.MsoBodyTextIndent, div.MsoBodyTextIndent
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:27.0pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoBodyText3, li.MsoBodyText3, div.MsoBodyText3
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:8.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.normal, li.normal, div.normal
	{mso-style-name:normal;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.problem0, li.problem0, div.problem0
	{mso-style-name:problem0;
	margin-top:3.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:35.45pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:Verdana;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.format0, li.format0, div.format0
	{mso-style-name:format0;
	margin-top:3.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:35.45pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:Verdana;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	font-weight:bold;
	font-style:italic;}
p.inout, li.inout, div.inout
	{mso-style-name:inout;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
p.sampleheader, li.sampleheader, div.sampleheader
	{mso-style-name:sampleheader;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	font-size:8.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.problem1, li.problem1, div.problem1
	{mso-style-name:problem1;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-indent:22.7pt;
	mso-pagination:widow-orphan;
	font-size:14.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.couriernew11pt, li.couriernew11pt, div.couriernew11pt
	{mso-style-name:couriernew11pt;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	font-size:13.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
p.problemstatement, li.problemstatement, div.problemstatement
	{mso-style-name:problemstatement;
	margin-top:2.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:35.45pt;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.problemexamplecaption, li.problemexamplecaption, div.problemexamplecaption
	{mso-style-name:problemexamplecaption;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
p.problemexample, li.problemexample, div.problemexample
	{mso-style-name:problemexample;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";}
p.problemstatement0, li.problemstatement0, div.problemstatement0
	{mso-style-name:problemstatement0;
	margin-top:2.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:35.45pt;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.problemexamplecaption0, li.problemexamplecaption0, div.problemexamplecaption0
	{mso-style-name:problemexamplecaption0;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
p.problemexample0, li.problemexample0, div.problemexample0
	{mso-style-name:problemexample0;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";}
span.problem
	{mso-style-name:problem;
	font-family:Verdana;
	mso-ascii-font-family:Verdana;
	mso-hansi-font-family:Verdana;}
span.format
	{mso-style-name:format;
	font-family:Verdana;
	mso-ascii-font-family:Verdana;
	mso-hansi-font-family:Verdana;
	font-weight:bold;
	font-style:italic;}
span.couriernew
	{mso-style-name:couriernew;
	font-family:"Courier New";
	mso-ascii-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:2.0cm 42.5pt 2.0cm 3.0cm;
	mso-header-margin:35.4pt;
	mso-footer-margin:35.4pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Обычная таблица";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";}
</style>
<![endif]-->
</head>

<body lang=RU style='tab-interval:35.4pt'>

<div class=Section1>

<h2 align=center style='margin:0cm;margin-bottom:.0001pt;text-align:center'><span
style='font-size:12.0pt;font-style:normal'>1040. Матрица</span></h2>

<p class=MsoNormal style='text-align:justify;text-indent:28.5pt'><span
style='font-size:12.0pt'>Произведением матрицы <sub><img width=94 height=30
id="_x0000_i1025" src="text.files/image001.gif"></sub>&nbsp;и матрицы <sub><img
width=91 height=30 id="_x0000_i1026" src="text.files/image002.gif"></sub>&nbsp;назовем
матрицу <sub><img width=87 height=29 id="_x0000_i1027"
src="text.files/image003.gif"></sub>&nbsp;такую, что </span></p>

<p class=MsoNormal align=center style='text-align:center;text-indent:28.5pt'><sub><span
style='font-size:12.0pt'><img width=106 height=55 id="_x0000_i1028"
src="text.files/image004.gif"></span></sub></p>

<p class=MsoNormal style='text-align:justify;text-indent:28.5pt'><span
style='font-size:12.0pt'>Из определения следует, что произведение матриц
определено только в том случае, если число столбцов </span><b><span lang=EN-US
style='font-size:12.0pt;mso-ansi-language:EN-US'>A</span></b><span
style='font-size:12.0pt'> равно числу строк матрицы </span><b><span lang=EN-US
style='font-size:12.0pt;mso-ansi-language:EN-US'>B</span></b><span
style='font-size:12.0pt'>. Для того чтобы вычислить матрицу </span><b><span
lang=EN-US style='font-size:12.0pt;mso-ansi-language:EN-US'>C</span></b><span
style='font-size:12.0pt'>, необходимо сделать </span><span class=SpellE><b><span
lang=EN-US style='font-size:12.0pt;mso-ansi-language:EN-US'>mpn</span></b></span><span
style='font-size:12.0pt'> умножений.</span></p>

<p class=MsoNormal style='text-align:justify;text-indent:28.5pt'><span
style='font-size:12.0pt'>Операция умножений матриц ассоциативна, т.е. </span><b><span
lang=EN-US style='font-size:12.0pt;mso-ansi-language:EN-US'>A</span></b><b><span
style='font-size:12.0pt'>*(</span></b><b><span lang=EN-US style='font-size:
12.0pt;mso-ansi-language:EN-US'>B</span></b><b><span style='font-size:12.0pt'>*</span></b><b><span
lang=EN-US style='font-size:12.0pt;mso-ansi-language:EN-US'>C</span></b><b><span
style='font-size:12.0pt'>)=(</span></b><b><span lang=EN-US style='font-size:
12.0pt;mso-ansi-language:EN-US'>A</span></b><b><span style='font-size:12.0pt'>*</span></b><b><span
lang=EN-US style='font-size:12.0pt;mso-ansi-language:EN-US'>B</span></b><b><span
style='font-size:12.0pt'>)*</span></b><b><span lang=EN-US style='font-size:
12.0pt;mso-ansi-language:EN-US'>C</span></b><span style='font-size:12.0pt'>.
Используя это свойство можно резко сократить количество выполняемых операций
для вычисления произведения более чем двух матриц.</span></p>

<p class=MsoNormal style='text-align:justify;text-indent:28.5pt'><span
style='font-size:12.0pt'>Например, пусть нужно вычислить произведение трех
матриц </span><b><span lang=EN-US style='font-size:12.0pt;mso-ansi-language:
EN-US'>A</span></b><b><sub><span style='font-size:12.0pt'>1</span></sub></b><span
style='font-size:12.0pt'>, </span><b><span lang=EN-US style='font-size:12.0pt;
mso-ansi-language:EN-US'>A</span></b><b><sub><span style='font-size:12.0pt'>2</span></sub></b><span
style='font-size:12.0pt'>, </span><b><span lang=EN-US style='font-size:12.0pt;
mso-ansi-language:EN-US'>A</span></b><b><sub><span style='font-size:12.0pt'>3</span></sub></b><span
style='font-size:12.0pt'> размеров 10</span><span class=SpellE><span
style='font-size:12.0pt;font-family:Symbol'>&acute;</span><span
style='font-size:12.0pt'>100,</span></span><span style='font-size:12.0pt'> 100</span><span
class=SpellE><span style='font-size:12.0pt;font-family:Symbol'>&acute;</span><span
style='font-size:12.0pt'>5,</span></span><span style='font-size:12.0pt'> <span
class=SpellE>5<span style='font-family:Symbol'>&acute;</span>50</span>
соответственно. При вычислении произведения <b>(</b></span><b><span lang=EN-US
style='font-size:12.0pt;mso-ansi-language:EN-US'>A</span></b><b><sub><span
style='font-size:12.0pt'>1</span></sub></b><b><span lang=EN-US
style='font-size:12.0pt;mso-ansi-language:EN-US'>A</span></b><b><sub><span
style='font-size:12.0pt'>2</span></sub></b><b><span style='font-size:12.0pt'>)</span></b><b><span
lang=EN-US style='font-size:12.0pt;mso-ansi-language:EN-US'>A</span></b><b><sub><span
style='font-size:12.0pt'>3</span></sub></b><span style='font-size:12.0pt'>
нужно 10*100*5=5000 умножений, чтобы найти матрицу </span><b><span lang=EN-US
style='font-size:12.0pt;mso-ansi-language:EN-US'>A</span></b><b><sub><span
style='font-size:12.0pt'>1</span></sub></b><b><span lang=EN-US
style='font-size:12.0pt;mso-ansi-language:EN-US'>A</span></b><b><sub><span
style='font-size:12.0pt'>2</span></sub></b><span style='font-size:12.0pt'>, а
затем 10*5*50=2500 умножений, чтобы умножить эту матрицу на </span><b><span
lang=EN-US style='font-size:12.0pt;mso-ansi-language:EN-US'>A</span></b><b><sub><span
style='font-size:12.0pt'>3</span></sub></b><span style='font-size:12.0pt'>.
Всего 7500 умножений. А при вычислении произведения </span><b><span lang=EN-US
style='font-size:12.0pt;mso-ansi-language:EN-US'>A</span></b><b><sub><span
style='font-size:12.0pt'>1</span></sub></b><b><span style='font-size:12.0pt'>(</span></b><b><span
lang=EN-US style='font-size:12.0pt;mso-ansi-language:EN-US'>A</span></b><b><sub><span
style='font-size:12.0pt'>2</span></sub></b><b><span lang=EN-US
style='font-size:12.0pt;mso-ansi-language:EN-US'>A</span></b><b><sub><span
style='font-size:12.0pt'>3</span></sub></b><b><span style='font-size:12.0pt'>)</span></b><span
style='font-size:12.0pt'> мы делаем 100*5*50=25000 умножений для нахождения
матрицы </span><b><span lang=EN-US style='font-size:12.0pt;mso-ansi-language:
EN-US'>A</span></b><b><sub><span style='font-size:12.0pt'>2</span></sub></b><b><span
lang=EN-US style='font-size:12.0pt;mso-ansi-language:EN-US'>A</span></b><b><sub><span
style='font-size:12.0pt'>3</span></sub></b><span style='font-size:12.0pt'>,
плюс еще 10*100*50=5000 умножений (умножение </span><b><span lang=EN-US
style='font-size:12.0pt;mso-ansi-language:EN-US'>A</span></b><b><sub><span
style='font-size:12.0pt'>1</span></sub></b><span style='font-size:12.0pt'> на </span><b><span
lang=EN-US style='font-size:12.0pt;mso-ansi-language:EN-US'>A</span></b><b><sub><span
style='font-size:12.0pt'>2</span></sub></b><b><span lang=EN-US
style='font-size:12.0pt;mso-ansi-language:EN-US'>A</span></b><b><sub><span
style='font-size:12.0pt'>3</span></sub></b><span style='font-size:12.0pt'>), итого
75000 вычислений. Тем самым, первый способ расстановки скобок в 10 раз
выгоднее.</span></p>

<p class=MsoNormal style='text-align:justify;text-indent:28.5pt'><span
style='font-size:12.0pt'>В <span class=GramE>общем</span> случае приходится
вычислять произведение вида <sub><img width=103 height=24 id="_x0000_i1029"
src="text.files/image005.gif"></sub>. Если вычислять такое произведение “в
лоб”, то очень вероятно, что даже самый быстрый компьютер не успеет его
посчитать за относительно маленькое время. Если же для этого произведения
выбирать оптимальную расстановку скобок, то время вычислений может уменьшиться
в тысячи или даже миллионы раз.</span></p>

<p class=MsoNormal style='text-align:justify;text-indent:28.5pt'><span
style='font-size:12.0pt'>Ваша задача по заданному числу </span><b><span
lang=EN-US style='font-size:12.0pt;mso-ansi-language:EN-US'>n</span></b><span
style='font-size:12.0pt'> и размерам матриц <sub><img width=103 height=24
id="_x0000_i1030" src="text.files/image005.gif"></sub>&nbsp;найти минимальное
количество умножений.</span></p>

<p class=MsoNormal style='text-indent:28.5pt'><b><i><span style='font-size:
12.0pt'>Входные данные:</span></i></b></p>

<p class=MsoNormal style='text-align:justify;text-indent:28.5pt'><span
style='font-size:12.0pt'>В первой строке входного файла содержится количество
тестов </span><b><span lang=EN-US style='font-size:12.0pt;mso-ansi-language:
EN-US'>T</span></b><span style='font-size:12.0pt'>. Каждый тест содержит две
строки. В первой строке входного файла находится число </span><b><span
lang=EN-US style='font-size:12.0pt;mso-ansi-language:EN-US'>N</span></b><span
style='font-size:12.0pt'> (3<span class=SpellE>&#8804;</span></span><b><span
lang=EN-US style='font-size:12.0pt;mso-ansi-language:EN-US'>N</span></b><span
class=SpellE><span style='font-size:12.0pt'>&#8804;80</span></span><span
style='font-size:12.0pt'>). В следующей строке находятся <b>(</b></span><b><span
lang=EN-US style='font-size:12.0pt;mso-ansi-language:EN-US'>N</span></b><b><span
style='font-size:12.0pt'>+1)</span></b><span style='font-size:12.0pt'> число –
количество строк </span><b><span lang=EN-US style='font-size:12.0pt;mso-ansi-language:
EN-US'>A</span></b><b><sub><span style='font-size:12.0pt'>1</span></sub></b><span
style='font-size:12.0pt'>, количество столбцов </span><b><span lang=EN-US
style='font-size:12.0pt;mso-ansi-language:EN-US'>A</span></b><b><sub><span
style='font-size:12.0pt'>1</span></sub></b><span style='font-size:12.0pt'>,
количество столбцов </span><b><span lang=EN-US style='font-size:12.0pt;
mso-ansi-language:EN-US'>A</span></b><b><sub><span style='font-size:12.0pt'>2</span></sub></b><span
style='font-size:12.0pt'>, …, количество столбцов </span><b><span lang=EN-US
style='font-size:12.0pt;mso-ansi-language:EN-US'>A<sub>n</sub></span></b><span
style='font-size:12.0pt'>. Количество строк и столбцов для любой матрицы не
превышает 100000.</span></p>

<p class=MsoNormal style='text-indent:28.5pt'><b><i><span style='font-size:
12.0pt'>Выходные данные:</span></i></b></p>

<p class=MsoNormal style='text-align:justify;text-indent:28.5pt'><span
style='font-size:12.0pt'>Выходной файл должен состоять из </span><b><span
lang=EN-US style='font-size:12.0pt;mso-ansi-language:EN-US'>T</span></b><span
style='font-size:12.0pt'> строк. Для каждого теста надо вывести одно число –
минимальное количество умножений.</span></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr style='mso-yfti-irow:0;height:10.25pt'>
  <td width=345 valign=top style='width:259.1pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:10.25pt'>
  <p class=MsoBodyTextIndent align=center style='text-align:center;text-indent:
  0cm'><b><span style='font-family:"Courier New"'>Пример теста</span></b></p>
  </td>
  <td width=345 valign=top style='width:259.1pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt;height:10.25pt'>
  <p class=MsoBodyTextIndent align=center style='text-align:center;text-indent:
  0cm'><b><span style='font-family:"Courier New"'>Пример ответа</span></b></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;mso-yfti-lastrow:yes;height:22.7pt'>
  <td width=345 valign=top style='width:259.1pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt;height:22.7pt'>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:12.0pt;
  font-family:"Courier New"'>1</span></p>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:12.0pt;
  font-family:"Courier New"'>3</span></p>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:12.0pt;
  font-family:"Courier New"'>10 100 5 50</span></p>
  </td>
  <td width=345 valign=top style='width:259.1pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt;height:22.7pt'>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:12.0pt;
  font-family:"Courier New"'>7500</span></p>
  </td>
 </tr>
</table>

<h2 style='margin:0cm;margin-bottom:.0001pt'><span style='font-size:12.0pt;
font-family:"Times New Roman";mso-bidi-font-style:normal'>Источник:</span><span
style='font-size:12.0pt;font-family:"Times New Roman";font-weight:normal;
font-style:normal;mso-bidi-font-style:italic'> Денис Назаров. Олимпиады
школьников в Уфе.</span><span lang=EN-US style='font-size:12.0pt;mso-ansi-language:
EN-US;font-style:normal;mso-bidi-font-style:italic'><o:p></o:p></span></h2>

</div>

</body>

</html>
